{% extends 'base.html' %}
{% load static %}
{% block title %}HR Manager | Manage Leaves | QuickPay{% endblock %}

{% block content %}
<style>
    /* Prevent filter buttons from stretching */
    .filter-btns .btn {
        min-width: 100px;
        font-weight: 500;
    }

    /* Smooth highlighting of active filter */
    .filter-btns .btn.active {
        color: white !important;
    }

    .card {
        border-radius: 12px;
    }
</style>

<div class="container mt-5">

    <h3 class="text-center mb-4">Manage Leaves</h3>

    <!-- FILTER BUTTONS -->
    <div class="d-flex justify-content-center mb-4 gap-2 flex-wrap filter-btns">
        <a href="{% url 'manage_leaves' %}?status=pending"
           class="btn btn-outline-warning {% if status_filter == 'pending' %}active bg-warning text-dark{% endif %}">
           Pending
        </a>

        <a href="{% url 'manage_leaves' %}?status=approved"
           class="btn btn-outline-success {% if status_filter == 'approved' %}active bg-success{% endif %}">
           Approved
        </a>

        <a href="{% url 'manage_leaves' %}?status=rejected"
           class="btn btn-outline-danger {% if status_filter == 'rejected' %}active bg-danger{% endif %}">
           Rejected
        </a>

        <a href="{% url 'manage_leaves' %}?status=all"
           class="btn btn-outline-secondary {% if status_filter == 'all' %}active bg-secondary{% endif %}">
           All
        </a>
    </div>

    <!-- LEAVE LIST -->
    {% if leaves %}
        <div class="row g-4 justify-content-center">
            {% for i in leaves %}
                <div class="col-md-5">
                    <div class="card shadow-sm">
                        <div class="card-body">

                            <h5 class="fw-semibold">{{ i.em.user.get_full_name }}</h5>

                            <p class="mb-1"><strong>Leave Type:</strong> {{ i.get_type_display }}</p>
                            <p class="mb-2"><strong>Applied On:</strong> {{ i.applied_on|date:"M d, Y" }}</p>

                            <span class="badge
                                {% if i.status == 'approved' %} bg-success
                                {% elif i.status == 'rejected' %} bg-danger
                                {% else %} bg-warning text-dark {% endif %}">
                                {{ i.status|capfirst }}
                            </span>

                            <div class="mt-3 text-end">
                                <a href="{% url 'view_leave' i.id %}" class="btn btn-primary btn-sm">View Details</a>
                            </div>

                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-center text-muted mt-4">No leave requests available.</p>
    {% endif %}

</div>

{% endblock %}

